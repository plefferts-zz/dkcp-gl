webpackJsonp([1],[function(e,t,r){function n(){var e=c.identity(new Float32Array(16));return new l({renderOrder:10,getUniforms:function(t){return t==y?{camera:g.computeMatrix(),camera2:e}:{camera:t.camera.computeMatrix(),camera2:t.camera2}},factory:function(){var e=100,t=new p.Float(e,4),r=new m(function(){return"  gl_Position = camera2 * camera * position; \n  f_color = colors[int(color)]; \n"},function(){return"  gl_FragColor = f_color ;\n"});r.attributes.position="vec4",r.attributes.color="float",r.varyings.f_color="vec4",r.vertex_uniforms.camera="mat4",r.vertex_uniforms.camera2="mat4",r.vertex_uniforms["colors["+e+"]"]="vec4";var n=new d(this,r,100);return n.addAttribute("position",4,"Float32Array",function(e,t){return t.vertices[e]}),n.addAttribute("color",1,"Float32Array",function(e,r){return[t.add(r.color,r,function(){return r.color.color})]}),n.uniforms.colors=t.buffer,n}})}function i(e){this.framebuffers=e,E.call(this)}function a(e,t){this.size=e,this.depth=t;var r={texture:u.createTexture(_,{target:_.TEXTURE_2D,width:this.size,height:this.size,min:_.LINEAR,mag:_.LINEAR,format:_.RGBA,type:_.UNSIGNED_BYTE,wrapS:_.CLAMP_TO_EDGE,wrapT:_.CLAMP_TO_EDGE})};if(this.depth){var n=_.createRenderbuffer();_.bindRenderbuffer(_.RENDERBUFFER,n),_.renderbufferStorage(_.RENDERBUFFER,_.DEPTH_COMPONENT16,this.size,this.size)}this.framebuffers=[];for(var i=0;1>i;++i){var a=_.createFramebuffer();_.bindFramebuffer(_.FRAMEBUFFER,a),_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,r.texture,0),this.depth&&_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.RENDERBUFFER,n);var o=_.checkFramebufferStatus(_.FRAMEBUFFER);if(o!=_.FRAMEBUFFER_COMPLETE)throw"gl.checkFramebufferStatus() returned "+WebGLDebugUtils.glEnumToString(o);this.framebuffers.push(a)}_.bindRenderbuffer(_.RENDERBUFFER,null),this.texture=r}function o(e,t){D.render(_,e-1,t-1)}function s(e,t){D.render(_,P=e-1,U=t-1)}var u=r(7),c=r(7).m4,f=r(1),l=f.Renderable,d=f.Model,h=f.Plate,m=(f.shaders,f.Shader),p=f.Allocation,v=r(3),E=f.RenderSet,b=(f.camera.BasicCamera,new f({canvas:document.getElementById("canvas"),frameRate:{element:document.getElementById("framerate")},wasd:{document:document,delta:.05,theta:-Math.PI/120}})),g=b.camera,y=b.screen,_=b.screen.gl,F=function(e,t,r,n){return[[e-n,t-n,r,1],[e-n,t+n,r,1],[e+n,t-n,r,1],[e+n,t+n,r,1]]},R={id:"red",color:[1,0,0,1]},T={id:"green",color:[0,1,0,1]},A={id:"blue",color:[0,0,1,1]},w={id:"white",color:[1,1,1,1]},x=n();y.addRenderable(x),x.add({color:R,allocations:{},vertices:F(.25,0,.7,.05)}),x.add({color:T,allocations:{},vertices:F(0,.25,.7,.05)}),x.add({color:A,allocations:{},vertices:F(0,0,.9,.05)}),x.add({color:w,allocations:{},vertices:F(0,0,.7,.01)}),v.inherits(i,E),i.prototype.render=function(e,t,r){for(var n=0;1>n;++n){this.framebuffers.bind(n),this.camera=b.camera;var i=Math.max(g.frameWidth,g.frameHeight),a=new Float32Array(16);c.translate(c.scaling([i,i,1]),[2*(.5-t/g.frameWidth),-2*(.5-r/g.frameHeight),0],a),this.camera2=a,E.prototype.render.call(this,e)}this.framebuffers.unbind()},a.prototype.bind=function(e){_.bindFramebuffer(_.FRAMEBUFFER,this.framebuffers[e]),_.viewport(0,0,this.size,this.size)},a.prototype.unbind=function(){_.bindFramebuffer(_.FRAMEBUFFER,null),_.viewport(0,0,_.drawingBufferWidth||_.canvas.width,_.drawingBufferHeight||_.canvas.height)};var B=new a(2,!0);B.unbind();var D;!function(){D=new i(B);var e=new m(function(){return"  gl_Position = position; \n"},function(){return"  gl_FragColor = vec4(0.5,0.5,0.5,1.0); \n"});e.attributes.position="vec4";var t=new h(e);t.add({z:-.5});var r={};c.identity(new Float32Array(16)),c.identity(new Float32Array(16)),c.identity(new Float32Array(16));D.addRenderable({before:function(){_.clearColor(0,0,0,0),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT)},renderOrder:0}),D.addRenderable({renderOrder:11,render:function(e){e.disable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE_MINUS_DST_ALPHA,e.DST_ALPHA,e.ONE,e.ONE);var n=t.getGeometry(e);t.drawPrep(n,r),n.draw(),e.disable(e.BLEND),e.enable(e.DEPTH_TEST)}}),D.addRenderable(x),y.addRenderable({before:function(){_.clearColor(0,0,0,0),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT)},renderOrder:0})}(),function(){var e=new m(function(){return"  v_pos       = position; \n  gl_Position = camera * vec4(position.x / 4.0, position.y / 4.0, 1.5, 1.0); \n"},function(){return"  gl_FragColor = texture2D(                            \n      texture,                                         \n      vec2(v_pos.x / 2.0 + 0.5, v_pos.y / 2.0 + 0.5)); \n"});e.attributes.position="vec4",e.fragment_uniforms.texture="sampler2D",e.vertex_uniforms.camera="mat4",e.varyings.v_pos="vec4";var t=new h(e);t.textureData={texture:B.texture},t.add({z:1});var r={};c.identity(new Float32Array(16));y.addRenderable({renderOrder:30,render:function(e){e.disable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE_MINUS_DST_ALPHA,e.DST_ALPHA,e.ONE,e.ONE),g.computeMatrix(),r.camera=g.matrix,r.texture=t.textureData.texture.texture;var n=t.getGeometry(e);t.drawPrep(n,r),n.draw(),e.disable(e.BLEND),e.enable(e.DEPTH_TEST)}})}(),y.beginFrameRendering(!1);var P,U;y.on("moved",function(){D.render(_,P,U)}),document.getElementById("canvas").addEventListener("click",function(e){var t=document.getElementById("canvas").getBoundingClientRect();o((e.clientX-t.left)/t.width*g.frameWidth,(e.clientY-t.top)/t.height*g.frameHeight)}),document.getElementById("canvas").addEventListener("mousemove",function(e){var t=document.getElementById("canvas").getBoundingClientRect();s((e.clientX-t.left)/t.width*g.frameWidth,(e.clientY-t.top)/t.height*g.frameHeight)})}]);
//# sourceMappingURL=bundle.js.map