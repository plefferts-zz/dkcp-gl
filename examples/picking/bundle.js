webpackJsonp([1],[function(e,r,t){function n(){return new f({renderOrder:10,getUniforms:function(e){return{camera:e==b?p.computeMatrix():e.camera.computeMatrix()}},factory:function(){var e=100,r=new m.Float(e,4),t=new E(function(){return"  gl_Position = camera * position; \n  f_color = colors[int(color)]; \n"},function(){return"  gl_FragColor = f_color ;\n"});t.attributes.position="vec4",t.attributes.color="float",t.varyings.f_color="vec4",t.vertex_uniforms.camera="mat4",t.vertex_uniforms["colors["+e+"]"]="vec4";var n=new d(this,t,100);return n.addAttribute("position",4,"Float32Array",function(e,r){return r.vertices[e]}),n.addAttribute("color",1,"Float32Array",function(e,t){return[r.add(t.color,t,function(){return t.color.color})]}),n.uniforms.colors=r.buffer,n}})}function a(e){this.framebuffers=e,h.call(this)}function i(e,r){this.size=e,this.depth=r;var t={texture:s.createTexture(T,{target:T.TEXTURE_2D,width:this.size,height:this.size,min:T.LINEAR,mag:T.LINEAR,format:T.RGBA,type:T.UNSIGNED_BYTE,wrapS:T.CLAMP_TO_EDGE,wrapT:T.CLAMP_TO_EDGE})};if(this.depth){var n=T.createRenderbuffer();T.bindRenderbuffer(T.RENDERBUFFER,n),T.renderbufferStorage(T.RENDERBUFFER,T.DEPTH_COMPONENT16,this.size,this.size)}this.framebuffers=[];for(var a=0;1>a;++a){var i=T.createFramebuffer();T.bindFramebuffer(T.FRAMEBUFFER,i),T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_2D,t.texture,0),this.depth&&T.framebufferRenderbuffer(T.FRAMEBUFFER,T.DEPTH_ATTACHMENT,T.RENDERBUFFER,n);var o=T.checkFramebufferStatus(T.FRAMEBUFFER);if(o!=T.FRAMEBUFFER_COMPLETE)throw"gl.checkFramebufferStatus() returned "+WebGLDebugUtils.glEnumToString(o);this.framebuffers.push(i)}T.bindRenderbuffer(T.RENDERBUFFER,null),this.texture=t}function o(e,r){U.render(T),console.log(Math.floor(e),Math.floor(r))}var s=t(7),c=t(7).m4,u=t(1),f=u.Renderable,d=u.Model,l=u.Plate,E=(u.shaders,u.Shader),m=u.Allocation,_=t(3),h=u.RenderSet,v=(u.camera.BasicCamera,new u({canvas:document.getElementById("canvas"),frameRate:{element:document.getElementById("framerate")},wasd:{document:document,delta:.05,theta:-Math.PI/120}})),p=v.camera,b=v.screen,T=v.screen.gl,F=function(e,r,t,n){return[[e-n,r-n,t,1],[e-n,r+n,t,1],[e+n,r-n,t,1],[e+n,r+n,t,1]]},R={id:"red",color:[1,0,0,1]},g={id:"green",color:[0,1,0,1]},A={id:"blue",color:[0,0,1,1]},y={id:"white",color:[1,1,1,1]},B=n();b.addRenderable(B),B.add({color:R,allocations:{},vertices:F(.25,0,.7,.05)}),B.add({color:g,allocations:{},vertices:F(0,.25,.7,.05)}),B.add({color:A,allocations:{},vertices:F(0,0,.9,.05)}),B.add({color:y,allocations:{},vertices:F(0,0,.7,.01)}),_.inherits(a,h),a.prototype.render=function(e){for(var r=0;1>r;++r)this.framebuffers.bind(r),this.camera=v.camera,h.prototype.render.call(this,e);this.framebuffers.unbind()},i.prototype.bind=function(e){T.bindFramebuffer(T.FRAMEBUFFER,this.framebuffers[e]),T.viewport(0,0,this.size,this.size)},i.prototype.unbind=function(){T.bindFramebuffer(T.FRAMEBUFFER,null),T.viewport(0,0,T.drawingBufferWidth||T.canvas.width,T.drawingBufferHeight||T.canvas.height)};var D=new i(1024,!0);D.unbind();var U;!function(){U=new a(D);var e=new E(function(){return"  gl_Position = position; \n"},function(){return"  gl_FragColor = vec4(0.5,0.5,0.5,1.0); \n"});e.attributes.position="vec4";var r=new l(e);r.add({z:-.5});var t={};c.identity(new Float32Array(16)),c.identity(new Float32Array(16)),c.identity(new Float32Array(16));U.addRenderable({before:function(){T.clearColor(0,0,0,0),T.clear(T.COLOR_BUFFER_BIT|T.DEPTH_BUFFER_BIT)},renderOrder:0}),U.addRenderable({renderOrder:11,render:function(e){e.disable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE_MINUS_DST_ALPHA,e.DST_ALPHA,e.ONE,e.ONE);var n=r.getGeometry(e);r.drawPrep(n,t),n.draw(),e.disable(e.BLEND),e.enable(e.DEPTH_TEST)}}),U.addRenderable(B),b.addRenderable({before:function(){T.clearColor(0,0,0,0),T.clear(T.COLOR_BUFFER_BIT|T.DEPTH_BUFFER_BIT)},renderOrder:0})}(),function(){var e=new E(function(){return"  v_pos       = position; \n  gl_Position = camera * vec4(position.x / 4.0, position.y / 4.0, 1.5, 1.0); \n"},function(){return"  gl_FragColor = texture2D(                            \n      texture,                                         \n      vec2(v_pos.x / 2.0 + 0.5, v_pos.y / 2.0 + 0.5)); \n"});e.attributes.position="vec4",e.fragment_uniforms.texture="sampler2D",e.vertex_uniforms.camera="mat4",e.varyings.v_pos="vec4";var r=new l(e);r.textureData={texture:D.texture},r.add({z:1});var t={};c.identity(new Float32Array(16));b.addRenderable({renderOrder:30,render:function(e){e.disable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE_MINUS_DST_ALPHA,e.DST_ALPHA,e.ONE,e.ONE),p.computeMatrix(),t.camera=p.matrix,t.texture=r.textureData.texture.texture;var n=r.getGeometry(e);r.drawPrep(n,t),n.draw(),e.disable(e.BLEND),e.enable(e.DEPTH_TEST)}})}(),b.beginFrameRendering(!1),document.getElementById("canvas").addEventListener("click",function(e){var r=document.getElementById("canvas").getBoundingClientRect();o((e.clientX-r.left)/r.width*p.frameWidth,(e.clientY-r.top)/r.height*p.frameHeight)})}]);
//# sourceMappingURL=bundle.js.map